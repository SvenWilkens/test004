<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title></title>
    <style>
        div {
           
           
        }

        .container {
            border: 1px solid blue;
        }

        .sdk {
            display: inline-block;
            border: 1px solid black;
            padding: 10px;
   
        }

        .border {
            border: 1px solid black;
            padding: 10px;
        }

        textarea {
            width: 100%;
            height: 400px;
        }

        .hidden {
            visibility: hidden;
            display: none;
        }

        .dropdown {
            max-width: 300px;
        }


      

 
    </style>
</head>

<body>
    <h3>Test page 3</h3>
    <template class="container">
       
       <div style="background-color: white; display: block;" class="sdk" index="{index-template}">
            <input id="widgetKey{index-template}" type="hidden" value="e3ce8a5436134ff4a0148bd77fe73e7b" />
            <input typea="text" id="apiUrl{index-template}" type="hidden" value="https://interact.de-01.luware.cloud/api/interact/v1" />
            <input id="contactId{index-template}" type="hidden" value="3c18c1f0-e796-4d9b-b2fc-f17e57db608f" />
                <div  class="div1" style="background-color:white">
        
                    UserName: 
                        <input id="userName{index-template}" />
                        <button id="initSDK{index-template}" onclick="setName(this)" >Name Ã¼bernehmen</button>
                        <button id="startVideo{index-template}"onclick="BeforeStartCall(this)" disabled> Videoanruf starten </button>
                        <button id="startAudio{index-template}" onclick="startAudio(this)" disabled > startAudio </button>
                        <button id="stopCall{index-template}" onclick="stopCall(this)" disabled>stopCall
                            <input id="email{index-template}" type="hidden" />
                            <input id="serviceId{index-template}" type="hidden" />
                           
                    </button>
                    <button onclick="ChangeSettings('settings',this)" >
                        Einstellungen
                    </button>
                </div>
                    <div id="settings" class="div1"  hidden="hidden">
                  
                        <span>List of devices: </span><select id="videos_list{index-template}" class="dropdown">
                            <option value="0"></option>
                        </select><br /><span>List of speakers: </span><select id="audios_list{index-template}" class="dropdown">
                            <option value="0"></option>
                        </select><br /><span>List of microphones: </span><select id="microphones_list{index-template}"
                            class="dropdown">
                            <option value="0"></option>
                        </select><br /><button title="update" onclick="updateDevices(this)">
                            Update devices
                        </button>
                   
                    </div>
                    <div style="display: block;" >
                        <table style="width: 100%; min-height: 400px; table-layout: fixed;background-color:azure">
                            <tr>
                                <td id="testSelfVideo{index-template}" style="max-width:50%;width: 50%; height: 100%; background-color:black ;text-align: center;" >
                                   <div id="selfVideoWait" hidden="hidden">
                                    <img  src="my/wait.gif" style="visibility: visible;">
                                   </div>
                                  
                            
                                </td>
                                <td  id="testVideo{index-template}" style="max-width:50%;width: 50%; height: 100%; background-color: black;text-align: center;">
                                   <div id="remoteVideoWait" hidden="hidden">
                                    <img  src="my/wait.gif" style="visibility:visible">
                                </div>
                                 
                                </td>
                                
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <div  id="screensharing-id{index-template}" style="width: 100%;"></div>
                                </td>
                            </tr>
                        </table>
                       <div hidden="hidden">
                        <audio id="testAudio{index-template}"       autoplay="true">1</audio>
                        <video id="testPresentation{index-template}" autoplay="true">2</video>
                     
                        <video id="testScreenSharing{index-template}" autoplay="true">3</video>
                    </div>
          
                       
                    </div>
                        <div  >
                    
                            <button id="toggleCamera" onclick="toggleCamera(this)" disabled ">
                                Kamera
                            </button>
                            <button id="toggleMute" onclick="toggleMute(this)" disabled >
                                Audio 
                            </button>
                            <button id="screenSharing" onclick="changeScreenSharing(this)" disabled>
                                Teilen
                            </button>
                        </div>
                
                    
                 </div>
                 <div>
                    <button id="edit{index-template}" onclick="editMessage(this)" disabled="disabled">Edit<Button>
						<button id="delete{index-template}" onclick="deleteMessage(this)" disabled="disabled">Delete </button>
						<button id="send{index-template}" onclick="sendMessage(this)" disabled="disabled"> send</button>
                        <textarea id="details{index-template}" hidden="hidden"></textarea>
                        <button id="sendTone{index-template}" title="sendTone{index-template}" onclick="sendTone(this)" disabled="disabled"> send Dtmf tone</button>
                        <button id="subscribeToPresenceOnly{index-template}" title="subscribeToPresenceOnly" onclick="subscribeToPresence(
                            this,
                             'presence_contactId_1{index-template}', 
                             'presence_contactId_2{index-template}',
                             'presence_serviceId_1{index-template}',
                             'presence_serviceId_2{index-template}')">
                            subscribe
                        </button>
                        <button id="unsubscribeToPresenceOnly{index-template}" title="unsubscribeToPresenceOnly" onclick="unsubscribeToPresence(
                            this,
                             'presence_contactId_1{index-template}', 
                             'presence_contactId_2{index-template}',
                             'presence_serviceId_1{index-template}',
                             'presence_serviceId_2{index-template}'
                             )">
                            unsubscribe
                        </button>
                        <button title="getCallState{index-template}" onclick="getCallState(this)">
                            getCallState
                        </button>
                        <button id="getServiceStatus{index-template}"
                            onclick="getServiceStatus(this, 'serviceId{index-template}', 'serviceName{index-template}')">
                            getServiceStatus</button>
                            <button title="stopChat{index-template}" onclick="stopChat(this)">
                                stopChat
                            </button>
                            <button
                            id="getContactStatus{index-template}" hidden
                            onclick="getContactStatus(this, 'contactId{index-template}', 'agentName{index-template}')">
                            getContactStatus
                        </button>
                        <button id="getContactPresence{index-template}" hidden
                            onclick="getContactPresence(this, 'contactId{index-template}')">
                            getContactPresence
                        </button>
                        <button title="getCallState{index-template}" hidden onclick="getCallState(this)">
                            getCallState
                        </button>
                        <button
                            title="startChat{index-template}" onclick="startChatContact(this)">
                            startChat
                        </button>
                        <button
                        id="updateToken{index-template}" onclick="updateToken(this, 'token{index-template}')">
                        Update Token {index-template}</button>
                        <input id="initial_message{index-template}" />
                        <input id="initial_service_message{index-template}" />
                       <input id="presence_contactId_1{index-template}"  value="" />
                       <input id="presence_contactId_2{index-template}" value="" />
                       <input id="presence_serviceId_1{index-template}"  value="" />
                       <input id="presence_serviceId_2{index-template}" value="" />
                       <input id="message{index-template}">
                       <button id="changeCamera{index-template}" onclick="changeCamera(this)" disabled="disabled">
                        changeCamera
                    </button>
                 </div>
                
            </div>
       
      



       
      
    </template>
    <script src="./nimbus.interact.sdk.js"></script>
    <script src="./nimbus.interact.presences.sdk.js"></script>
    <script src="./my/call.js"></script>
    <script>
       let isSettingsVisible = false;
       let _sdkByIndex = new Map()
       let sdkCount = 1

        for (let i = 1; i <= sdkCount; i++) {
            let id = `_${i}`
      
            createSdk(id)
            initValues(id)
            fillListOfDevices(id)
            
            
        }
       // var botton = document.getElementById('initSDK_1')
       // initSDK(botton)

        //TODO: add support
        interactSDK.errors(onError)

        


        async function setName(button){
            document.getElementById('initSDK_1').disabled = true
            document.getElementById('userName_1').disabled = true
            document.getElementById("startAudio_1").disabled = false
            document.getElementById("stopCall_1").disabled = true
            document.getElementById("startVideo_1").disabled = false
            initSDK(button)
        }

        async function BeforeStartCall(button){
            var image = document.getElementById('selfVideoWait')
            image.hidden = false;
            var remoteImage = document.getElementById('remoteVideoWait')
            remoteImage.hidden = false;
            startVideo(button)
        }



        async function AfterStartCall(){
            var image = document.getElementById('selfVideoWait')
            image.hidden = true;
            var remoteImage = document.getElementById('remoteVideoWait')
            remoteImage.hidden = true;
        }

        async function ChangeSettings(settingsDivId, botton){
            var div = document.getElementById(settingsDivId)
            if(isSettingsVisible){    
                
                div.hidden = false
                isSettingsVisible = false;
            }
            else{    
                div.hidden = true
                isSettingsVisible = true;
            }
        }
    </script>
</body>

</html>